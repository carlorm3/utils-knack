var Soluntech=function(e){this.applicationID=e.applicationID,this.restAPIkey=e.restAPIkey,this.knackURL=e.knackURL||"https://api.knack.com/v1/",this.jQuery=e.jQuery||window.$,this.environment=e.environment||"production",this.isProduction="production"===this.environment,this.isDevelopment="development"===this.environment,this.$spinnerBackdrop=null,this.libraries=e.libraries||{moment:{url:"https://cdnjs.cloudflare.com/ajax/libs/moment.js/2.18.1/moment.js",loaded:!1,objectName:"moment"},async:{url:"https://cdnjs.cloudflare.com/ajax/libs/async/2.4.1/async.min.js",loaded:!1,objectName:"async"},jquery:{url:"https://cdnjs.cloudflare.com/ajax/libs/jquery/2.2.4/jquery.min.js",loaded:!1,objectName:"jQuery"},idleTimer:{url:"https://cdnjs.cloudflare.com/ajax/libs/jquery-idletimer/1.0.0/idle-timer.min.js",loaded:!1,objectName:"idleTimer"},chartjs:{url:"https://cdnjs.cloudflare.com/ajax/libs/Chart.js/2.7.3/Chart.min.js",loaded:!1,objectName:"chartjs"}},this.assert(Knack||window.Knack,"Error, this library only run on Knack applications"),this.assert(this.jQuery,"Error, jQuery instance is required")};Object.defineProperty(Soluntech.prototype,"$",{get:function(){return window.jQuery||this.jQuery||window.$}}),Soluntech.prototype.set=function(e,t){Object.defineProperty(Soluntech.prototype,e,{get:function(){return t}})},Soluntech.prototype.log=function(){var e=Array.prototype.slice.call(arguments);console&&"function"==typeof console.log&&this.isDevelopment&&console.log.apply(console,e)},Soluntech.prototype.warn=function(){var e=Array.prototype.slice.call(arguments);console&&"function"==typeof console.warn&&this.isDevelopment&&console.warn.apply(console,e)},Soluntech.prototype.error=function(){var e=Array.prototype.slice.call(arguments);console&&"function"==typeof console.error&&this.isDevelopment&&console.error.apply(console,e)},Soluntech.prototype.debug=function(){var e=Array.prototype.slice.call(arguments);console&&"function"==typeof console.debug&&this.isDevelopment&&console.debug.apply(console,e)},Soluntech.prototype.assert=function(e,t){if(!e)throw new Error(t)},Object.defineProperty(Soluntech.prototype,"headers",{get:function(){return{"X-Knack-Application-ID":this.applicationID,"X-Knack-REST-API-Key":this.restAPIkey,"content-type":"application/json"}}}),Soluntech.prototype.next=function(e){setTimeout(function(){e()},0)},Soluntech.prototype.showSpinner=function(e){this.$spinnerBackdrop||(this.$spinnerBackdrop=this.$('<div style="z-index: 100000; position: absolute; top: 0; left: 0; right: 0; bottom: 0;"></div>'),this.$spinnerBackdrop.appendTo("body"),this.next(function(){Knack.showSpinner(),"function"==typeof e&&e()}))},Soluntech.prototype.hideSpinner=function(e){this.$spinnerBackdrop&&(this.$spinnerBackdrop.remove(),this.$spinnerBackdrop=null),this.next(function(){Knack.hideSpinner(),"function"==typeof e&&e()})},Soluntech.prototype.load=function(e,t){var o=this;LazyLoad.js(e,function(){t.call(o)})},Soluntech.prototype.loadLibrary=function(){var t,e=Array.prototype.slice.call(arguments),o=e.pop(),n=[],r=this;if(e.forEach(function(e){(t=r.libraries[e])&&!t.loaded&&(t.loaded=!0,n.push(t.url))}),!n.length)return o.call(this);this.load(n,o)},Soluntech.prototype.libraryIsLoaded=function(e){var t=this.libraries[e];return!!t&&t.loaded},Soluntech.prototype.insertLibrary=function(e,t){this.libraries[e]||(this.libraries[e]={url:t,loaded:!1})},Soluntech.prototype.addTask=function(e,t,o){this.$(document).on(t,o.bind(this))},Soluntech.prototype.addMethod=function(e,t){Object.defineProperty(Soluntech.prototype,e,{get:function(){return t.bind(this)}})},Soluntech.prototype.librariesRequired=function(){var t,e=Array.prototype.slice.call(arguments),o=this;e.forEach(function(e){t=o.libraries[e],o.assert(t,'Library "'+e+"\" don' exists"),o.assert(window[t.objectName],'Library "'+e+'" is required')})},Soluntech.prototype.find=function(e,t,o,n,r){t=t||[],n=n||"",o=o||"",r=r||"all";var i=encodeURIComponent(JSON.stringify(t)),c=encodeURIComponent(o),s=encodeURIComponent(n);return this.$.ajax({type:"GET",headers:this.headers,url:this.knackURL+"objects/"+e+"/records?rows_per_page="+r+"&filters="+i+"&sort_field="+c+"&sort_order="+s})},Soluntech.prototype.findById=function(e,t){return this.$.ajax({type:"GET",headers:this.headers,url:this.knackURL+"objects/"+e+"/records/"+t})},Soluntech.prototype.update=function(e,t,o){return this.$.ajax({type:"PUT",headers:this.headers,url:this.knackURL+"objects/"+e+"/records/"+t,data:o})},Soluntech.prototype.delete=function(e,t){return this.$.ajax({type:"DELETE",headers:this.headers,url:this.knackURL+"objects/"+e+"/records/"+t})},Soluntech.prototype.deleteMultiple=function(o,e,t){var n=e.filters||[],r=e.sortOrder||"",i=e.sortField||"",c=e.recordPerPage||"all",s=encodeURIComponent(JSON.stringify(n)),a=encodeURIComponent(i),l=encodeURIComponent(r),u=this;u.$.ajax({type:"GET",headers:u.headers,url:u.knackURL+"objects/"+o+"/records?rows_per_page="+c+"&filters="+s+"&sort_field="+a+"&sort_order="+l}).then(function(e){var t=e.records.map(function(e){return e.id});return t.length?u.$.ajax({type:"POST",headers:u.headers,url:u.knackURL+"objects/"+o+"/records/delete",data:{ids:t}}):null}).then(function(e){return t(null,e),null}).fail(t)},Soluntech.prototype.enableElement=function(e){var t=this.$(e);t&&t.length&&t.removeAttr("disabled")},Soluntech.prototype.disableElement=function(e){var t=this.$(e);t&&t.length&&t.attr("disabled","disabled")},Soluntech.prototype.create=function(e,t){return this.$.ajax({type:"POST",headers:this.headers,url:this.knackURL+"objects/"+e+"/records",data:t})},Soluntech.prototype.getFieldValue=function(e,t,o){if(!e)return e;if("raw"===o||"number"===o)return e[t+"_raw"];if("date"===o){var n={};return(r=e[t+"_raw"])||n}if("name"===o){n={first:"",last:""};return(r=e[t+"_raw"])||n}if("email"===o)return(r=e[t+"_raw"])&&r.email;if("image"===o||"file"===o){n={url:""};return(r=e[t+"_raw"])||n}if("address"===o){n={city:"",state:"",stree:"",street2:"",zip:""};return(r=e[t+"_raw"])||n}if("connection"!==o)return e[t];var r;n={id:null,identifier:""};return(r=e[t+"_raw"])?Array.isArray(r)?r.length<1?n:1===r.length?r[0]:r:r:n},Soluntech.prototype.valueIsId=function(e){var t=(e+="").length,o=!1;return 12!=t&&24!=t||(o=/^[0-9a-fA-F]+$/.test(e)),o},Soluntech.prototype.updateQueryStringParameter=function(e,t,o){o=o||window.location.href;var n=new RegExp("([?&])"+e+"=.*?(&|$)","i"),r=-1!==o.indexOf("?")?"&":"?";return o.match(n)?o.replace(n,"$1"+e+"="+t+"$2"):o+r+e+"="+t},Soluntech.prototype.updateLocationWithoutReloading=function(e){window.history.pushState&&window.history.pushState({path:e},"",e)},Soluntech.prototype.getParameterByName=function(e,t){t=t||window.location.href,e=e.replace(/[\[\]]/g,"\\$&");var o=new RegExp("[?&]"+e+"(=([^&#]*)|&|#|$)").exec(t);return o?o[2]?decodeURIComponent(o[2].replace(/\+/g," ")):"":null},Soluntech.prototype.showInstructions=function(e,t,o){var n=this.$(e).find("p.kn-instructions");o=o||"black",n.html(t),n.css("color",o),n.show()},Soluntech.prototype.hideInstructions=function(e){var t=this.$(e).find("p.kn-instructions");t.html(""),t.hide()},Soluntech.prototype.refreshView=function(e,t){t=t||function(){};try{Knack.views[e].model.fetch({success:function(){Knack.views[e].render(),t()}})}catch(e){t(e)}},Soluntech.prototype.removeIfIsInDOM=function(e){var t=this.$(e);return!(!t||!t.length)&&(t.remove(),!0)},Object.defineProperty(Soluntech.prototype,"isAuthenticated",{get:function(){return!!Knack.user.id}}),Soluntech.prototype.startIdleTimer=function(e){var r={selector:document,timeout:3e5,idle:!1,userGoesIdleCallback:function(){},userBecomesActive:function(){}},t=this;t.$.extend(r,e||{}),t.loadLibrary("jquery","idleTimer",function(){t.$(r.selector).idleTimer({idle:r.idle,timeout:r.timeout}),t.$(r.selector).on("idle.idleTimer",function(e,t,o){r.userGoesIdleCallback(e,t,o)}),t.$(r.selector).on("active.idleTimer",function(e,t,o,n){r.userBecomesActive(e,t,o,n)})})},Soluntech.prototype.updateIdleTimer=function(e){var t={selector:document,event:"destroy"},o=this;o.$.extend(t,e||{}),o.loadLibrary("jquery","idleTimer",function(){o.$(t.selector).idleTimer(t.event),o.$(t.selector).off("idle.idleTimer"),o.$(t.selector).off("active.idleTimer")})},Soluntech.prototype.logout=function(){var e=document.getElementsByClassName("kn-log-out");e&&e[0]&&e[0].click()};